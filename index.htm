<script>
    async function submitFeedback() {
        const name = document.getElementById('name').value;
        const team = document.getElementById('team').value;
        const rating = document.getElementById('rating').value;
        const notes = document.getElementById('notes').value;

        if (!name || !team || !rating) {
            alert('Please fill out all required fields.');
            return;
        }

        const context = `Feedback for Karan:\n\nName of the person providing feedback: ${name}\nTeam of the person providing feedback: ${team}\nRating provided (out of 5): ${rating}\n\nKaran is a technical integrations consultant. He is responsible for ensuring seamless integration of systems and resolving technical issues efficiently.\n\nNotes provided by the feedback giver: ${notes || 'No additional notes provided.'}`;

        const data = {
            inputs: `Can you write a professional feedback for Karan based on the following details? ${context}`
        };

        try {
            const output = await query(data);
            const outputBox = document.getElementById('output');
            if (output && output.generated_text) {
                outputBox.innerHTML = `<strong>Generated Feedback:</strong> <br> ${output.generated_text}`;
            } else {
                outputBox.innerHTML = "Unable to generate feedback.";
            }
        } catch (error) {
            console.error("Error generating feedback:", error);
            document.getElementById('output').innerHTML = "An error occurred while generating feedback.";
        }
    }

    function copyToClipboard() {
        const outputBox = document.getElementById('output');
        const text = outputBox.textContent || outputBox.innerText;
        navigator.clipboard.writeText(text).then(() => {
            alert('Output copied to clipboard!');
        }).catch(err => {
            alert('Failed to copy output to clipboard.');
        });
    }

    async function query(payload) {
        const API_URL = "https://api-inference.huggingface.co/models/google/flan-t5-large";
        const headers = { "Authorization": "Bearer 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" };

        const response = await fetch(API_URL, {
            method: "POST",
            headers: headers,
            body: JSON.stringify(payload)
        });
        return response.json();
    }
</script>
